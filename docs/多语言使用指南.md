# 多语言使用指南

## 概述

项目采用统一的多语言管理方案，支持基础文本获取和变量替换功能，实现动态内容显示。

## 功能特性

- ✅ 统一使用 `languageService.getText()` 方法
- ✅ 支持 `{{变量名}}` 格式的变量占位符
- ✅ 支持字符串和数字类型的变量
- ✅ 向后兼容，不影响现有代码
- ✅ 类型安全的变量传递
- ✅ 完整的 TypeScript 支持

## 使用方法

### 1. 基础文本获取

```typescript
import { languageService } from '@/services/languageService';

// 获取基础文本
const title = languageService.getText('SITE_TITLE');
const homeText = languageService.getText('HOME');
const aboutText = languageService.getText('ABOUT');
```

### 2. 变量替换功能

#### 在语言文件中定义带变量的文本

**中文 (zh-CN.json):**
```json
{
  "SEARCH_RESULTS_COUNT": "找到 {{count}} 篇文章",
  "ARTICLE_READ_TIME": "预计阅读时间 {{minutes}} 分钟",
  "FOLDER_ARTICLES_COUNT": "{{folder}} 文件夹中共有 {{count}} 篇文章"
}
```

**英文 (en-US.json):**
```json
{
  "SEARCH_RESULTS_COUNT": "Found {{count}} articles",
  "ARTICLE_READ_TIME": "Estimated reading time: {{minutes}} minutes",
  "FOLDER_ARTICLES_COUNT": "{{count}} articles in {{folder}} folder"
}
```

#### 在组件中使用变量替换

```typescript
// 单个变量
const searchResults = languageService.getText('SEARCH_RESULTS_COUNT', { 
  count: 15 
});

// 多个变量
const folderStats = languageService.getText('FOLDER_ARTICLES_COUNT', { 
  folder: '项目管理', 
  count: 12 
});

// 数字变量
const readTime = languageService.getText('ARTICLE_READ_TIME', { 
  minutes: 8 
});
```

### 3. 变量命名规范

- 使用有意义的变量名，如 `count`、`name`、`date` 等
- 变量名只能包含字母、数字和下划线
- 建议使用小写字母和下划线的组合
- 变量名区分大小写

### 4. 支持的变量类型

```typescript
interface LocaleVariables {
  [key: string]: string | number;
}
```

- **字符串**: `{ name: '大米', folder: '项目管理' }`
- **数字**: `{ count: 15, minutes: 8 }`
- **混合**: `{ name: '模板', count: 5, code: 'ABC123' }`

## 实际应用示例

### 搜索结果统计
```typescript
// 语言文件
"SEARCH_RESULTS_COUNT": "找到 {{count}} 篇文章"

// 组件中使用
const resultText = languageService.getText('SEARCH_RESULTS_COUNT', { 
  count: articles.length 
});
// 输出: "找到 15 篇文章"
```

### 阅读时间显示
```typescript
// 语言文件
"ARTICLE_READ_TIME": "预计阅读时间 {{minutes}} 分钟"

// 组件中使用
const timeText = languageService.getText('ARTICLE_READ_TIME', { 
  minutes: article.readingTime 
});
// 输出: "预计阅读时间 8 分钟"
```

### 文件夹统计
```typescript
// 语言文件
"FOLDER_ARTICLES_COUNT": "{{folder}} 文件夹中共有 {{count}} 篇文章"

// 组件中使用
const statsText = languageService.getText('FOLDER_ARTICLES_COUNT', { 
  folder: '项目管理', 
  count: 12 
});
// 输出: "项目管理 文件夹中共有 12 篇文章"
```

## 迁移指南

### 从硬编码文本迁移

**之前:**
```typescript
{language === 'zh-CN' 
  ? `找到 ${articles.length} 篇文章`
  : `Found ${articles.length} articles`
}
```

**现在:**
```typescript
{languageService.getText('SEARCH_RESULTS_COUNT', { count: articles.length })}
```

### 从条件渲染迁移

**之前:**
```typescript
{language === 'zh-CN' ? '关于我们' : 'About Us'}
{article.readingTime} {language === 'zh-CN' ? '分钟' : 'min read'}
```

**现在:**
```typescript
{languageService.getText('ABOUT_US')}
{languageService.getText('ARTICLE_READ_TIME', { minutes: article.readingTime })}
```

## 最佳实践

### 1. 代码规范
- **统一使用**: 所有多语言文本都通过 `languageService.getText()` 获取
- **避免硬编码**: 不要在组件中直接写中英文条件判断
- **类型安全**: 确保传递的变量类型正确
- **键名规范**: 使用大写字母和下划线的组合，如 `SEARCH_RESULTS_COUNT`

### 2. 语言文件管理
- **一致性**: 中英文语言文件保持相同的键名结构
- **完整性**: 确保所有键都有对应的中英文翻译
- **变量支持**: 需要变量替换的文本使用 `{{变量名}}` 格式
- **注释说明**: 复杂或特殊的文本可以添加注释说明

### 3. 开发流程
- **新增文本**: 先在语言文件中添加键值对，再在组件中使用
- **测试验证**: 使用测试工具验证变量替换功能
- **向后兼容**: 新功能不影响现有的无变量文本

## 测试工具

项目提供了测试工具来验证多语言功能：

```typescript
import { testLanguageVariables, validateLanguageFiles } from '@/utils/languageTest';

// 在浏览器控制台中运行
testLanguageVariables();
validateLanguageFiles();
```

## 注意事项

1. **变量占位符格式**: 必须为 `{{变量名}}`
2. **变量不存在**: 如果变量不存在，会保留原始占位符
3. **变量名大小写**: 变量名区分大小写
4. **嵌套使用**: 支持嵌套使用，但建议保持简单
5. **保留合理用法**: 日期格式化函数和CSS类名判断可以保留

## 常见问题

### Q: 如何添加新的多语言文本？
A: 1. 在 `src/locales/zh-CN.json` 中添加中文文本
   2. 在 `src/locales/en-US.json` 中添加英文文本
   3. 在组件中使用 `languageService.getText('KEY_NAME')`

### Q: 如何支持变量替换？
A: 1. 在语言文件中使用 `{{变量名}}` 格式
   2. 在组件中传递变量对象作为第二个参数
   3. 例如: `languageService.getText('KEY', { var: 'value' })`

### Q: 如何验证多语言功能？
A: 使用项目提供的测试工具：
   - `testLanguageVariables()`: 测试变量替换功能
   - `validateLanguageFiles()`: 验证语言文件完整性

## 总结

通过统一的多语言管理方案，项目实现了：
- ✅ 统一的多语言获取方式
- ✅ 支持变量替换的动态内容
- ✅ 类型安全的开发体验
- ✅ 易于维护和扩展的架构
- ✅ 完整的测试和验证工具

这样的优化让多语言管理更加统一和可维护，避免了硬编码和条件判断的复杂性，为项目的国际化发展奠定了良好的基础。 