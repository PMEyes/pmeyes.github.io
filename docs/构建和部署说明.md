# 构建和部署说明

## 构建流程

### 自动清理
- 在每次构建前，会自动删除 `dist` 目录
- 使用 `npm run clean` 命令手动清理

### 构建命令
```bash
npm run build
```

构建过程包括：
1. 清理 `dist` 目录
2. 生成文章数据
3. TypeScript 编译
4. Vite 生产构建

## Git 钩子自动部署 (Husky)

### 自动部署机制
- 使用 [Husky](https://typicode.github.io/husky/) 管理 Git 钩子
- 当在 `main` 分支上执行 `git push` 时，会自动触发部署
- 部署过程包括构建和推送到 GitHub Pages
- 其他分支的 push 不会触发部署

### 钩子配置
- 钩子文件位于 `.husky/pre-push`
- 使用 `npm run prepare` 安装钩子（在 npm install 时自动执行）

### 手动部署
如果需要手动部署：
```bash
npm run deploy
```

## 脚本说明

### 可用脚本
- `npm run clean` - 删除 dist 目录
- `npm run build` - 构建项目（包含清理步骤）
- `npm run deploy` - 构建并部署到 GitHub Pages
- `npm run prepare` - 安装 Husky 钩子

### 钩子文件
- `.husky/pre-push` - Git pre-push 钩子脚本

## 注意事项

1. 确保在 main 分支上工作才能触发自动部署
2. 部署前会自动清理旧的构建文件
3. 如果部署失败，push 操作会被阻止
4. 钩子脚本会显示部署状态信息
5. Husky 钩子会在项目安装时自动设置 